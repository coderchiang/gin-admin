var e,t,o=(e,t,o)=>new Promise(((a,n)=>{var i=e=>{try{r(o.next(e))}catch(t){n(t)}},l=e=>{try{r(o.throw(e))}catch(t){n(t)}},r=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,l);r((o=o.apply(e,t)).next())}));import{_ as a,u as n}from"./useTable.5684c6cb.js";import{_ as i}from"./useForm.2dff632a.js";import{aE as l,h as r}from"./index.36aa7878.js";import{a0 as d,bi as s,j as c,K as m,o as p,m as u,n as b,P as f,X as h}from"./vendor.0af35baf.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./useWindowSizeFn.2da1ca2c.js";import"./useModal.07fec034.js";import"./onMountedOrActivated.28436c92.js";/* empty css              */import"./useSortable.d1b7c877.js";import"./useExpose.615d046e.js";/* empty css              *//* empty css              *//* empty css              */import"./index.cfa1e5e1.js";import"./download.3cbd7271.js";import"./StrengthMeter.bbf58d9a.js";(t=e||(e={})).LogList="/admin/log/list",t.LogDel="/admin/log/del",t.LogDelBatch="/admin/log/del_batch";const x=t=>l.get({url:e.LogList,params:t}),g=[{title:"操作用户",dataIndex:"operName",width:100},{title:"操作方法",dataIndex:"method",width:100},{title:"访问Url",dataIndex:"operUrl",width:180},{title:"客户端ip",dataIndex:"operIp",width:180},{title:"访问位置",dataIndex:"operLocation",width:180},{title:"系统",dataIndex:"os",width:100},{title:"平台",dataIndex:"platform",width:100},{title:"浏览器",dataIndex:"browser",width:100},{title:"操作状态",dataIndex:"status",width:80,customRender:({record:e})=>{const t=1==~~e.status,o=t?"成功":"失败";return d(s,{color:t?"green":"red"},(()=>o))}},{title:"操作时间",dataIndex:"operTime",width:180},{title:"备注",dataIndex:"remark"}],T=[{field:"datetime",component:"RangePicker",label:"起止日期",colProps:{span:8}},{field:"type",label:"日志类型",component:"Select",componentProps:{options:[{label:"登录日志",value:"1"},{label:"操作日志",value:"2"}]},colProps:{span:8}},{field:"method",label:"请求方法",component:"Select",componentProps:{options:[{label:"GET",value:"GET"},{label:"POST",value:"POST"},{label:"PUT",value:"PUT"},{label:"DELETE",value:"DELETE"}]},colProps:{span:8}},{field:"operName",label:"操作用户",component:"Input",colProps:{span:8}},{field:"ipaddr",label:"IP地址",component:"Input",colProps:{span:8}}];var w=c({name:"LogManagement",components:{BasicTable:a,TableAction:i},setup(){const[t,{reload:a,getSelectRowKeys:i}]=n({title:"日志列表",api:x,columns:g,formConfig:{labelWidth:120,schemas:T,fieldMapToTime:[["datetime",["startTime","endTime"],"YYYY-MM-DD HH:mm:ss"]]},useSearchForm:!0,showTableSetting:!0,bordered:!0,rowKey:"id",rowSelection:{type:"checkbox"},showIndexColumn:!1,actionColumn:{width:80,title:"操作",dataIndex:"action",slots:{customRender:"action"},fixed:void 0}}),{createConfirm:d}=r();return{registerTable:t,handleConfirm:function(t){return o(this,null,(function*(){d({iconType:t,title:"注意",content:"您打算批量删除数据库日志吗？",onOk:()=>{var t;t={ids:i()},l.delete({url:e.LogDelBatch,params:t}),setTimeout((()=>{a()}),200)}})}))},handleDelete:function(t){return o(this,null,(function*(){var o;(yield(o={id:t.id},l.delete({url:e.LogDel,params:o})))&&setTimeout((()=>{a()}),200)}))}}}});const j=h(" 批量删除 "),v=h(" 导出EXCEL ");w.render=function(e,t,o,a,n,i){const l=m("a-button"),r=m("TableAction"),d=m("BasicTable");return p(),u("div",null,[b(d,{onRegister:e.registerTable},{toolbar:f((()=>[b(l,{type:"warning",onClick:t[1]||(t[1]=t=>e.handleConfirm("warning"))},{default:f((()=>[j])),_:1}),b(l,{type:"success",onClick:e.handleDelete},{default:f((()=>[v])),_:1},8,["onClick"])])),action:f((({record:t})=>[b(r,{actions:[{icon:"ant-design:delete-outlined",color:"error",popConfirm:{title:"是否确认删除",confirm:e.handleDelete.bind(null,t)}}]},null,8,["actions"])])),_:1},8,["onRegister"])])};export default w;

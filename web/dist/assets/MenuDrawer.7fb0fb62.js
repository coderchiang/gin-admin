var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,o=Object.getOwnPropertySymbols,a=Object.prototype.propertyIsEnumerable,l=(t,o,a)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[o]=a,n=(e,t,o)=>new Promise(((a,l)=>{var n=e=>{try{i(o.next(e))}catch(t){l(t)}},r=e=>{try{i(o.throw(e))}catch(t){l(t)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,r);i((o=o.apply(e,t)).next())}));import{h as r,i}from"./useForm.6c7201a5.js";import{T as s}from"./index.39f227bd.js";import{c6 as u,aW as p,e as d,v as c,k as m,A as b,dN as f,dP as v,dQ as h,r as w,o as y,m as P,G as g,n as I,q as x}from"./index.c68bc564.js";import{_ as N,a as D}from"./useDrawer.cf8bc700.js";const R=[{title:"菜单名",dataIndex:"menuName",width:200,align:"left"},{title:"图标",dataIndex:"icon",width:50,customRender:({record:e})=>u(p,{icon:e.icon})},{title:"Api路由",dataIndex:"apiPath"},{title:"组件",dataIndex:"component"},{title:"排序",dataIndex:"orderNo",width:50},{title:"状态",dataIndex:"status",width:80,customRender:({record:e})=>{const t=1==~~e.status,o=t?"启用":"停用";return u(s,{color:t?"green":"red"},(()=>o))}},{title:"创建时间",dataIndex:"createTime",width:180}],B=e=>"2"===e,O=[{field:"menuName",label:"菜单名称",component:"Input",colProps:{span:8}},{field:"status",label:"状态",component:"Select",componentProps:{options:[{label:"启用",value:"1"},{label:"停用",value:"0"}]},colProps:{span:8}}],T=[{field:"type",label:"菜单类型",component:"RadioButtonGroup",defaultValue:"0",componentProps:{options:[{label:"目录",value:"0"},{label:"菜单",value:"1"},{label:"按钮",value:"2"}]},colProps:{lg:24,md:24}},{field:"id",label:"ID",component:"InputNumber",show:!1},{field:"pid",label:"pid",component:"InputNumber",show:!1},{field:"menuName",label:"菜单名称",component:"Input",required:!0},{field:"pMenuName",label:"上级菜单",component:"TreeSelect",componentProps:{replaceFields:{title:"menuName",key:"id",value:"id"},getPopupContainer:()=>document.body}},{field:"orderNo",label:"排序",component:"InputNumber",required:!0},{field:"icon",label:"图标",component:"IconPicker",required:!0,show:({values:e})=>!B(e.type)},{field:"apiPath",label:"apiPath",component:"Input",required:!0,show:({values:e})=>B(e.type)},{field:"apiMethod",label:"ApiMethod",component:"RadioButtonGroup",defaultValue:"1",required:!0,componentProps:{options:[{label:"GET",value:"1"},{label:"POST",value:"2"},{label:"PUT",value:"3"},{label:"DELETE",value:"4"}]},show:({values:e})=>B(e.type)},{field:"component",label:"组件路径",component:"Input",show:({values:e})=>"1"===e.type,required:!0},{field:"path",label:"请求路径",component:"Input",show:({values:e})=>!B(e.type),required:!0},{field:"isExt",label:"是否外链",component:"RadioButtonGroup",defaultValue:"0",componentProps:{options:[{label:"否",value:"0"},{label:"是",value:"1"}]},show:({values:e})=>!B(e.type)},{field:"extUrl",label:"外链地址",component:"Input",show:({values:e})=>"1"===e.isExt},{field:"keepalive",label:"是否缓存",component:"RadioButtonGroup",defaultValue:"1",componentProps:{options:[{label:"否",value:"0"},{label:"是",value:"1"}]},show:({values:e})=>!B(e.type)},{field:"status",label:"状态",component:"RadioButtonGroup",defaultValue:"1",componentProps:{options:[{label:"启用",value:"1"},{label:"禁用",value:"0"}]}}];var j=d({name:"MenuDrawer",components:{BasicDrawer:N,BasicForm:r},emits:["success","register"],setup(e,{emit:r}){const s=c(!0),[u,{resetFields:p,setFieldsValue:d,updateSchema:w,validate:y}]=i({labelWidth:100,schemas:T,showActionButtonGroup:!1,baseColProps:{lg:12,md:24}}),[P,{setDrawerProps:g,closeDrawer:I}]=D((e=>n(this,null,(function*(){p(),g({confirmLoading:!1}),s.value=!!(null==e?void 0:e.isUpdate),b(s)&&d(((e,n)=>{for(var r in n||(n={}))t.call(n,r)&&l(e,r,n[r]);if(o)for(var r of o(n))a.call(n,r)&&l(e,r,n[r]);return e})({},e.record));const n=yield f();w({field:"pMenuName",componentProps:{treeData:n}})}))));return{registerDrawer:P,registerForm:u,getTitle:m((()=>b(s)?"编辑菜单":"新增菜单")),handleSubmit:function(){return n(this,null,(function*(){try{const t=yield y();if(g({confirmLoading:!0}),0!=t.id&&null!=typeof t.id&&t.id)e=yield h(t);else var e=yield v(t);e&&(I(),r("success"))}finally{g({confirmLoading:!1})}}))}}}});j.render=function(e,t,o,a,l,n){const r=w("BasicForm"),i=w("BasicDrawer");return y(),P(i,x(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"50%",onOk:e.handleSubmit}),{default:g((()=>[I(r,{onRegister:e.registerForm},null,8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])};var F=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:j});export{F as M,j as _,R as c,O as s};

var e=Object.defineProperty,l=Object.defineProperties,n=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,r=(l,n,t)=>n in l?e(l,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[n]=t,s=(e,l)=>{for(var n in l||(l={}))o.call(l,n)&&r(e,n,l[n]);if(t)for(var n of t(l))a.call(l,n)&&r(e,n,l[n]);return e},i=(e,t)=>l(e,n(t)),c=(e,l,n)=>new Promise(((t,o)=>{var a=e=>{try{s(n.next(e))}catch(l){o(l)}},r=e=>{try{s(n.throw(e))}catch(l){o(l)}},s=e=>e.done?t(e.value):Promise.resolve(e.value).then(a,r);s((n=n.apply(e,l)).next())}));import{a4 as u,u as d,j as p,G as f,n as g,bl as h,a8 as m,r as b,i as v,C,I as y,$ as H,J as M,K as k,as as F,o as O,m as P,P as S,w as x,Q as w,b8 as j,b9 as T,bC as W,S as $,W as B,N as R,X as E,q as N,a5 as A,an as I,a1 as _,b1 as L,ag as V,z as D,t as q,b0 as z,Z as X}from"./vendor.0af35baf.js";import{e as Y,p as G,r as J,ab as K,aC as Q,x as Z,y as U,S as ee,c as le,ap as ne,j as te,aB as oe,ae,ar as re}from"./index.36aa7878.js";import{u as se}from"./useWindowSizeFn.2da1ca2c.js";const{t:ie}=Y(),ce={visible:G.bool,scrollTop:G.bool.def(!0),height:G.number,minHeight:G.number,draggable:G.bool.def(!0),centered:G.bool,cancelText:G.string.def(ie("common.cancelText")),okText:G.string.def(ie("common.okText")),closeFunc:Function},ue=Object.assign({},ce,{defaultFullscreen:G.bool,canFullscreen:G.bool.def(!0),wrapperFooterOffset:G.number.def(0),helpMessage:[String,Array],useWrapper:G.bool.def(!0),loading:G.bool,loadingTip:G.string,showCancelBtn:G.bool.def(!0),showOkBtn:G.bool.def(!0),wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:G.bool.def(!0),closeIcon:Object,confirmLoading:G.bool,destroyOnClose:G.bool,footer:Object,getContainer:Function,mask:G.bool.def(!0),maskClosable:G.bool.def(!0),keyboard:G.bool.def(!0),maskStyle:Object,okType:G.string.def("primary"),okButtonProps:Object,cancelButtonProps:Object,title:G.string,visible:G.bool,width:[String,Number],wrapClassName:G.string,zIndex:G.number});function de(e){const l=(e,l)=>getComputedStyle(e)[l],n=n=>{if(!n)return;n.setAttribute("data-drag",d(e.draggable));const t=n.querySelector(".ant-modal-header"),o=n.querySelector(".ant-modal");t&&o&&d(e.draggable)&&(t.style.cursor="move",t.onmousedown=e=>{if(!e)return;const n=e.clientX,t=e.clientY,a=document.body.clientWidth,r=document.documentElement.clientHeight,s=o.offsetWidth,i=o.offsetHeight,c=o.offsetLeft,u=a-o.offsetLeft-s,d=o.offsetTop,p=r-o.offsetTop-i,f=l(o,"left"),g=l(o,"top");let h=+f,m=+g;f.includes("%")?(h=+document.body.clientWidth*(+f.replace(/%/g,"")/100),m=+document.body.clientHeight*(+g.replace(/%/g,"")/100)):(h=+f.replace(/px/g,""),m=+g.replace(/px/g,"")),document.onmousemove=function(e){let l=e.clientX-n,a=e.clientY-t;-l>c?l=-c:l>u&&(l=u),-a>d?a=-d:a>p&&(a=p),o.style.cssText+=`;left:${l+h}px;top:${a+m}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})};u((()=>{d(e.visible)&&d(e.draggable)&&J((()=>{(()=>{const t=document.querySelectorAll(".ant-modal-wrap");for(const o of Array.from(t)){if(!o)continue;const t=l(o,"display"),a=o.getAttribute("data-drag");"none"!==t&&(null===a||d(e.destroyOnClose))&&n(o)}})()}),30)}))}var pe=p({name:"Modal",inheritAttrs:!1,props:ue,setup(e,{slots:l}){const{visible:n,draggable:t,destroyOnClose:o}=f(e),a=K();return de({visible:n,destroyOnClose:o,draggable:t}),()=>{let n;const t=s(s({},d(a)),e);return g(m,t,"function"==typeof(o=n=Q(l))||"[object Object]"===Object.prototype.toString.call(o)&&!h(o)?n:{default:()=>[n]});var o}}});const fe=Symbol();function ge(){return U(fe)}var he=p({name:"ModalWrapper",components:{ScrollContainer:ee},inheritAttrs:!1,props:{loading:G.bool,useWrapper:G.bool.def(!0),modalHeaderHeight:G.number.def(57),modalFooterHeight:G.number.def(74),minHeight:G.number.def(200),height:G.number,footerOffset:G.number.def(0),visible:G.bool,fullScreen:G.bool,loadingTip:G.string},emits:["height-change","ext-height"],setup(e,{emit:l}){const n=b(null),t=b(null),o=b(0),a=b(0);let r=0;se(i.bind(null,!1)),Z({redoModalHeight:i},fe);const s=v((()=>({minHeight:`${e.minHeight}px`,maxHeight:`${d(o)}px`})));function i(){return c(this,null,(function*(){if(!e.visible)return;const a=d(n);if(!a)return;const s=a.$el.parentElement;if(s){s.style.padding="0",yield M();try{const n=s.parentElement&&s.parentElement.parentElement;if(!n)return;const a=getComputedStyle(n).top,i=Number.parseInt(a);let c=window.innerHeight-2*i+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;i<40&&(c-=26),yield M();const u=d(t);if(!u)return;yield M(),r=u.scrollHeight,e.fullScreen?o.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:o.value=e.height?e.height:r>c?c:r,l("height-change",d(o))}catch(i){}}}))}return u((()=>{e.useWrapper&&i()})),C((()=>e.fullScreen),(e=>{i(),e?a.value=o.value:o.value=a.value})),y((()=>{const{modalHeaderHeight:n,modalFooterHeight:t}=e;l("ext-height",n+t)})),H((()=>{})),{wrapperRef:n,spinRef:t,spinStyle:s,scrollTop:function(){return c(this,null,(function*(){M((()=>{var e;const l=d(n);l&&(null==(e=null==l?void 0:l.scrollTo)||e.call(l,0))}))}))},setModalHeight:i}}});he.render=function(e,l,n,t,o,a){const r=k("ScrollContainer"),s=F("loading");return O(),P(r,{ref:"wrapperRef"},{default:S((()=>[x(g("div",{ref:"spinRef",style:e.spinStyle,"loading-tip":e.loadingTip},[w(e.$slots,"default")],12,["loading-tip"]),[[s,e.loading]])])),_:3},512)};var me=p({name:"ModalClose",components:{FullscreenExitOutlined:j,FullscreenOutlined:T,CloseOutlined:W},props:{canFullscreen:G.bool.def(!0),fullScreen:G.bool},emits:["cancel","fullscreen"],setup(e,{emit:l}){const{prefixCls:n}=le("basic-modal-close");return{getClass:v((()=>[n,`${n}--custom`,{[`${n}--can-full`]:e.canFullscreen}])),prefixCls:n,handleCancel:function(){l("cancel")},handleFullScreen:function(e){null==e||e.stopPropagation(),null==e||e.preventDefault(),l("fullscreen")}}}});me.render=function(e,l,n,t,o,a){const r=k("FullscreenExitOutlined"),s=k("FullscreenOutlined"),i=k("CloseOutlined");return O(),P("div",{class:e.getClass},[e.canFullscreen?(O(),P($,{key:0},[e.fullScreen?(O(),P(r,{key:0,role:"full",onClick:e.handleFullScreen},null,8,["onClick"])):(O(),P(s,{key:1,role:"close",onClick:e.handleFullScreen},null,8,["onClick"]))],64)):B("",!0),g(i,{onClick:e.handleCancel},null,8,["onClick"])],2)};var be=p({name:"BasicModalFooter",props:ue,emits:["ok","cancel"],setup:(e,{emit:l})=>({handleOk:function(){l("ok")},handleCancel:function(){l("cancel")}})});be.render=function(e,l,n,t,o,a){const r=k("a-button");return O(),P("div",null,[w(e.$slots,"insertFooter"),e.showCancelBtn?(O(),P(r,R({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:S((()=>[E(N(e.cancelText),1)])),_:1},16,["onClick"])):B("",!0),w(e.$slots,"centerFooter"),e.showOkBtn?(O(),P(r,R({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:S((()=>[E(N(e.okText),1)])),_:1},16,["type","onClick","loading"])):B("",!0),w(e.$slots,"appendFooter")])};var ve=p({name:"BasicModalHeader",components:{BasicTitle:ne},props:{helpMessage:{type:[String,Array]},title:G.string}});ve.render=function(e,l,n,t,o,a){const r=k("BasicTitle");return O(),P(r,{helpMessage:e.helpMessage},{default:S((()=>[E(N(e.title),1)])),_:1},8,["helpMessage"])};var Ce=p({name:"BasicModal",components:{Modal:pe,ModalWrapper:he,ModalClose:me,ModalFooter:be,ModalHeader:ve},inheritAttrs:!1,props:ue,emits:["visible-change","height-change","cancel","ok","register"],setup(e,{emit:l,attrs:n}){const t=b(!1),o=b(null),a=b(null),r=b(0),p={setModalProps:function(e){if(o.value=oe(d(o)||{},e),!Reflect.has(e,"visible"))return;t.value=!!e.visible},emitVisible:void 0,redoModalHeight:()=>{M((()=>{d(a)&&d(a).setModalHeight()}))}},f=_();f&&l("register",p,f.uid);const g=v((()=>s(s({},e),d(o)))),{handleFullScreen:h,getWrapClassName:m,fullScreenRef:y}=function(e){const l=b(!1);return{getWrapClassName:v((()=>{const n=d(e.wrapClassName)||"";return d(l)?`fullscreen-modal ${n} `:d(n)})),handleFullScreen:function(e){e&&e.stopPropagation(),l.value=!d(l)},fullScreenRef:l}}({modalWrapperRef:a,extHeightRef:r,wrapClassName:A(g.value,"wrapClassName")}),H=v((()=>{const e=i(s({},d(g)),{visible:d(t),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return i(s({},e),{wrapClassName:d(m)})})),k=v((()=>{const e=s(s({},n),d(H));return d(y)?I(e,"height"):e})),F=v((()=>{if(!d(y))return d(H).height}));return u((()=>{t.value=!!e.visible,y.value=!!e.defaultFullscreen})),C((()=>d(t)),(n=>{var t;l("visible-change",n),f&&(null==(t=p.emitVisible)||t.call(p,n,f.uid)),M((()=>{e.scrollTop&&n&&d(a)&&d(a).scrollTop()}))}),{immediate:!1}),{handleCancel:function(n){return c(this,null,(function*(){if(null==n||n.stopPropagation(),e.closeFunc&&te(e.closeFunc)){const l=yield e.closeFunc();t.value=!l}else t.value=!1,l("cancel")}))},getBindValue:k,getProps:H,handleFullScreen:h,fullScreenRef:y,getMergeProps:g,handleOk:function(){l("ok")},visibleRef:t,omit:I,modalWrapperRef:a,handleExtHeight:function(e){r.value=e},handleHeightChange:function(e){l("height-change",e)},handleTitleDbClick:function(l){e.canFullscreen&&(l.stopPropagation(),h(l))},getWrapperHeight:F}}});Ce.render=function(e,l,n,t,o,a){const r=k("ModalClose"),s=k("ModalHeader"),i=k("ModalFooter"),c=k("ModalWrapper"),u=k("Modal");return O(),P(u,R({onCancel:e.handleCancel},e.getBindValue),L({default:S((()=>[g(c,R({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,height:e.getWrapperHeight,visible:e.visibleRef,modalFooterHeight:void 0===e.footer||e.footer?void 0:0},e.omit(e.getProps.wrapperProps,"visible","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:S((()=>[w(e.$slots,"default")])),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","visible","modalFooterHeight","onExtHeight","onHeightChange"])])),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:S((()=>[g(r,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","onCancel","onFullscreen"])]))},e.$slots.title?void 0:{name:"title",fn:S((()=>[g(s,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","title","onDblclick"])]))},e.$slots.footer?void 0:{name:"footer",fn:S((()=>[g(i,R(e.getProps,{onOk:e.handleOk,onCancel:e.handleCancel}),L({_:2},[V(Object.keys(e.$slots),(l=>({name:l,fn:S((n=>[w(e.$slots,l,n)]))})))]),1040,["onOk","onCancel"])]))},V(Object.keys(e.omit(e.$slots,"default")),(l=>({name:l,fn:S((n=>[w(e.$slots,l,n)]))})))]),1040,["onCancel"])};const ye=D({}),He=D({});function Me(){const e=b(null),l=b(!1),n=b("");const t=()=>{const l=d(e);return l||re("useModal instance is undefined!"),l};return[function(t,o){n.value=o,H((()=>{e.value=null,l.value=!1,ye[d(n)]=null})),d(l)&&ae()&&t===d(e)||(e.value=t,t.emitVisible=(e,l)=>{He[l]=e})},{setModalProps:e=>{var l;null==(l=t())||l.setModalProps(e)},getVisible:v((()=>He[~~d(n)])),redoModalHeight:()=>{var e,l;null==(l=null==(e=t())?void 0:e.redoModalHeight)||l.call(e)},openModal:(e=!0,l,o=!0)=>{var a;if(null==(a=t())||a.setModalProps({visible:e}),!l)return;if(o)return ye[d(n)]=null,void(ye[d(n)]=q(l));z(q(ye[d(n)]),q(l))||(ye[d(n)]=q(l))},closeModal:()=>{var e;null==(e=t())||e.setModalProps({visible:!1})}}]}const ke=e=>{const l=b(null),n=_(),t=b(""),o=()=>{const e=d(l);return e||re("useModalInner instance is undefined!"),e};return u((()=>{const l=ye[d(t)];l&&e&&te(e)&&M((()=>{e(l)}))})),[(e,o)=>{X((()=>{l.value=null})),t.value=o,l.value=e,null==n||n.emit("register",e,o)},{changeLoading:(e=!0)=>{var l;null==(l=o())||l.setModalProps({loading:e})},getVisible:v((()=>He[~~d(t)])),changeOkLoading:(e=!0)=>{var l;null==(l=o())||l.setModalProps({confirmLoading:e})},closeModal:()=>{var e;null==(e=o())||e.setModalProps({visible:!1})},setModalProps:e=>{var l;null==(l=o())||l.setModalProps(e)},redoModalHeight:()=>{var e;const l=null==(e=o())?void 0:e.redoModalHeight;l&&l()}}]};export{Ce as _,ge as a,ke as b,Me as u};

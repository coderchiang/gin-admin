import{S as t,e,Q as n,R as i,a0 as r,$ as s,X as o,ai as a,n as u,W as c,bQ as l,U as h,a2 as p,aj as f,v as d,w as v,V as m,Y as g,Z as b,bZ as y}from"./index.c68bc564.js";import{U as O}from"./UpOutlined.b9c4ece0.js";function w(){return(w=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}var C=e({name:"TouchFeedback",mixins:[n],inheritAttrs:!1,props:i({disabled:t.looseBool,activeClassName:t.string,activeStyle:t.any},{disabled:!1}),data:function(){return this.child=null,{active:!1}},mounted:function(){var t=this;this.$nextTick((function(){t.disabled&&t.active&&t.setState({active:!1})}))},methods:{triggerEvent:function(t,e,n){var i="on".concat(t),r=this.child;r.props[i]&&r.props[i](n),e!==this.active&&this.setState({active:e})},onTouchStart:function(t){this.triggerEvent("Touchstart",!0,t)},onTouchMove:function(t){this.triggerEvent("Touchmove",!1,t)},onTouchEnd:function(t){this.triggerEvent("Touchend",!1,t)},onTouchCancel:function(t){this.triggerEvent("Touchcancel",!1,t)},onMouseDown:function(t){this.triggerEvent("Mousedown",!0,t)},onMouseUp:function(t){this.triggerEvent("Mouseup",!1,t)},onMouseLeave:function(t){this.triggerEvent("Mouseleave",!1,t)}},render:function(){var t=this.$props,e=t.disabled,n=t.activeClassName,i=void 0===n?"":n,u=t.activeStyle,c=void 0===u?{}:u,l=r(this);if(1!==l.length)return s(!1,"m-feedback组件只能包含一个子元素"),null;var h=e?void 0:{onTouchstart:this.onTouchStart,onTouchmove:this.onTouchMove,onTouchend:this.onTouchEnd,onTouchcancel:this.onTouchCancel,onMousedown:this.onMouseDown,onMouseup:this.onMouseUp,onMouseleave:this.onMouseLeave};if(l=l[0],this.child=l,!e&&this.active){var p=l.props,f=p.style,d=p.class;return!1!==c&&(c&&(f=w(w({},f),c)),d=o(d,i)),a(l,w({class:d,style:f},h))}return a(l,h)}}),x={name:"InputHandler",inheritAttrs:!1,props:{prefixCls:t.string,disabled:t.looseBool},render:function(){var t=this,e=this.$props,n=e.prefixCls,i={disabled:e.disabled,activeClassName:"".concat(n,"-handler-active")};return u(C,i,{default:function(){return[u("span",t.$attrs,[r(t)])]}})}};function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){V(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function V(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T(){return(T=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function N(t){t.preventDefault()}var M=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,E=function(t){return null!=t},j=function(t,e){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},D=e({name:"VCInputNumber",mixins:[n],inheritAttrs:!1,props:i({value:t.oneOfType([t.number,t.string]),defaultValue:t.oneOfType([t.number,t.string]),focusOnUpDown:t.looseBool,autofocus:t.looseBool,prefixCls:t.string,tabindex:t.oneOfType([t.string,t.number]),placeholder:t.string,disabled:t.looseBool,readonly:t.looseBool,max:t.number,min:t.number,step:t.oneOfType([t.number,t.string]),upHandler:t.any,downHandler:t.any,useTouch:t.looseBool,formatter:t.func,parser:t.func,precision:t.number,required:t.looseBool,pattern:t.string,decimalSeparator:t.string,autocomplete:t.string,title:t.string,name:t.string,id:t.string,type:t.string,maxlength:t.any},{focusOnUpDown:!0,useTouch:!1,prefixCls:"rc-input-number",min:-M,step:1,parser:function(t){return t.replace(/[^\w\.-]+/g,"")},required:!1,autocomplete:"off"}),data:function(){var t,e=c(this);this.prevProps=T({},e),t="value"in e?this.value:this.defaultValue;var n=this.getValidValue(this.toNumber(t));return{inputValue:this.toPrecisionAsStep(n),sValue:n,focused:this.autofocus}},mounted:function(){var t=this;this.$nextTick((function(){t.updatedFunc()}))},updated:function(){var t=this,e=this.$props,n=e.value,i=e.max,r=e.min,s=this.$data.focused,o=this.prevProps,a=c(this);if(o){if(!j(o.value,n)||!j(o.max,i)||!j(o.min,r)){var u,l=s?n:this.getValidValue(n);u=this.pressingUpOrDown?l:this.inputting?this.rawInput:this.toPrecisionAsStep(l),this.setState({sValue:l,inputValue:u})}var h="value"in a?n:this.$data.sValue;"max"in a&&o.max!==i&&"number"==typeof h&&h>i&&(this.__emit("update:value",i),this.__emit("change",i)),"min"in a&&o.min!==r&&"number"==typeof h&&h<r&&(this.__emit("update:value",r),this.__emit("change",r))}this.prevProps=T({},a),this.$nextTick((function(){t.updatedFunc()}))},beforeUnmount:function(){this.stop()},methods:{updatedFunc:function(){var t=this.inputRef;try{if(void 0!==this.cursorStart&&this.$data.focused)if(this.partRestoreByAfter(this.cursorAfter)||this.$data.sValue===this.value){if(this.currentValue===t.value)switch(this.lastKeyCode){case l.BACKSPACE:this.fixCaret(this.cursorStart-1,this.cursorStart-1);break;case l.DELETE:this.fixCaret(this.cursorStart+1,this.cursorStart+1)}}else{var e=this.cursorStart+1;this.cursorAfter?this.lastKeyCode===l.BACKSPACE?e=this.cursorStart-1:this.lastKeyCode===l.DELETE&&(e=this.cursorStart):e=t.value.length,this.fixCaret(e,e)}}catch(n){}this.lastKeyCode=null,this.pressingUpOrDown&&(this.focusOnUpDown&&this.$data.focused&&document.activeElement!==t&&this.focus(),this.pressingUpOrDown=!1)},onKeyDown:function(t){if(t.keyCode===l.UP){var e=this.getRatio(t);this.up(t,e),this.stop()}else if(t.keyCode===l.DOWN){var n=this.getRatio(t);this.down(t,n),this.stop()}else t.keyCode===l.ENTER&&this.__emit("pressEnter",t);this.recordCursorPosition(),this.lastKeyCode=t.keyCode;for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];this.__emit.apply(this,["keydown",t].concat(r))},onKeyUp:function(t){this.stop(),this.recordCursorPosition();for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.__emit.apply(this,["keyup",t].concat(n))},onTrigger:function(t){if(t.target.composing)return!1;this.onChange(t)},onChange:function(t){this.$data.focused&&(this.inputting=!0),this.rawInput=this.parser(this.getValueFromEvent(t)),this.setState({inputValue:this.rawInput});var e=this.toNumber(this.rawInput);this.__emit("update:value",e),this.__emit("change",e)},onFocus:function(){this.setState({focused:!0});for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.__emit.apply(this,["focus"].concat(e))},onBlur:function(){this.inputting=!1,this.setState({focused:!1});var t=this.getCurrentValidValue(this.$data.inputValue),e=this.setValue(t);if(this.$attrs.onBlur){var n=this.inputRef.value,i=this.getInputDisplayValue({focused:!1,sValue:e});this.inputRef.value=i;for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];this.__emit.apply(this,["blur"].concat(s)),this.inputRef.value=n}},getCurrentValidValue:function(t){var e=t;return e=""===e?"":this.isNotCompleteNumber(parseFloat(e,10))?this.$data.sValue:this.getValidValue(e),this.toNumber(e)},getRatio:function(t){var e=1;return t.metaKey||t.ctrlKey?e=.1:t.shiftKey&&(e=10),e},getValueFromEvent:function(t){var e=t.target.value.trim().replace(/。/g,".");return E(this.decimalSeparator)&&(e=e.replace(this.decimalSeparator,".")),e},getValidValue:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.min,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.max,i=parseFloat(t,10);return isNaN(i)?t:(i<e&&(i=e),i>n&&(i=n),i)},setValue:function(t,e){var n=this.$props.precision,i=this.isNotCompleteNumber(parseFloat(t,10))?null:parseFloat(t,10),r=this.$data,s=r.sValue,o=void 0===s?null:s,a=r.inputValue,u=void 0===a?null:a,c="number"==typeof i?i.toFixed(n):"".concat(i),l=i!==o||c!=="".concat(u);return h(this,"value")?this.setState({inputValue:this.toPrecisionAsStep(this.$data.sValue)},e):this.setState({sValue:i,inputValue:this.toPrecisionAsStep(t)},e),l&&(this.__emit("update:value",i),this.__emit("change",i)),i},getPrecision:function(t){if(E(this.precision))return this.precision;var e=t.toString();if(e.indexOf("e-")>=0)return parseInt(e.slice(e.indexOf("e-")+2),10);var n=0;return e.indexOf(".")>=0&&(n=e.length-e.indexOf(".")-1),n},getMaxPrecision:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(E(this.precision))return this.precision;var n=this.step,i=this.getPrecision(e),r=this.getPrecision(n),s=this.getPrecision(t);return t?Math.max(s,i+r):i+r},getPrecisionFactor:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.getMaxPrecision(t,e);return Math.pow(10,n)},getInputDisplayValue:function(t){var e,n=t||this.$data,i=n.focused,r=n.inputValue,s=n.sValue;null==(e=i?r:this.toPrecisionAsStep(s))&&(e="");var o=this.formatWrapper(e);return E(this.$props.decimalSeparator)&&(o=o.toString().replace(".",this.$props.decimalSeparator)),o},recordCursorPosition:function(){try{var t=this.inputRef;this.cursorStart=t.selectionStart,this.cursorEnd=t.selectionEnd,this.currentValue=t.value,this.cursorBefore=t.value.substring(0,this.cursorStart),this.cursorAfter=t.value.substring(this.cursorEnd)}catch(e){}},fixCaret:function(t,e){if(void 0!==t&&void 0!==e&&this.inputRef&&this.inputRef.value)try{var n=this.inputRef,i=n.selectionStart,r=n.selectionEnd;t===i&&e===r||n.setSelectionRange(t,e)}catch(s){}},restoreByAfter:function(t){if(void 0===t)return!1;var e=this.inputRef.value,n=e.lastIndexOf(t);if(-1===n)return!1;var i=this.cursorBefore.length;return this.lastKeyCode===l.DELETE&&this.cursorBefore.charAt(i-1)===t[0]?(this.fixCaret(i,i),!0):n+t.length===e.length&&(this.fixCaret(n,n),!0)},partRestoreByAfter:function(t){var e=this;return void 0!==t&&Array.prototype.some.call(t,(function(n,i){var r=t.substring(i);return e.restoreByAfter(r)}))},focus:function(){this.inputRef.focus(),this.recordCursorPosition()},blur:function(){this.inputRef.blur()},formatWrapper:function(t){return this.formatter?this.formatter(t):t},toPrecisionAsStep:function(t){if(this.isNotCompleteNumber(t)||""===t)return t;var e=Math.abs(this.getMaxPrecision(t));return isNaN(e)?t.toString():Number(t).toFixed(e)},isNotCompleteNumber:function(t){return isNaN(t)||""===t||null===t||t&&t.toString().indexOf(".")===t.toString().length-1},toNumber:function(t){var e=this.$props,n=e.precision,i=e.autofocus,r=this.$data.focused,s=void 0===r?i:r,o=t&&t.length>16&&s;return this.isNotCompleteNumber(t)||o?t:E(n)?Math.round(t*Math.pow(10,n))/Math.pow(10,n):Number(t)},upStep:function(t,e){var n=this.step,i=this.getPrecisionFactor(t,e),r=Math.abs(this.getMaxPrecision(t,e)),s=((i*t+i*n*e)/i).toFixed(r);return this.toNumber(s)},downStep:function(t,e){var n=this.step,i=this.getPrecisionFactor(t,e),r=Math.abs(this.getMaxPrecision(t,e)),s=((i*t-i*n*e)/i).toFixed(r);return this.toNumber(s)},stepFn:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0;if(this.stop(),e&&e.preventDefault(),!this.disabled){var s=this.max,o=this.min,a=this.getCurrentValidValue(this.$data.inputValue)||0;if(!this.isNotCompleteNumber(a)){var u=this["".concat(t,"Step")](a,i),c=u>s||u<o;u>s?u=s:u<o&&(u=o),this.setValue(u),this.setState({focused:!0}),c||(this.autoStepTimer=setTimeout((function(){n[t](e,i,!0)}),r?200:600))}}},stop:function(){this.autoStepTimer&&clearTimeout(this.autoStepTimer)},down:function(t,e,n){this.pressingUpOrDown=!0,this.stepFn("down",t,e,n)},up:function(t,e,n){this.pressingUpOrDown=!0,this.stepFn("up",t,e,n)},handleInputClick:function(){this.__emit("click")},saveUp:function(t){this.upHandlerRef=t},saveDown:function(t){this.downHandlerRef=t},saveInput:function(t){this.inputRef=t},onCompositionstart:function(t){t.target.composing=!0},onCompositionend:function(t){this.onChange(t),t.target.composing=!1}},render:function(){var t,e=T(T({},this.$props),this.$attrs),n=e.prefixCls,i=e.disabled,r=e.readonly,s=e.useTouch,a=e.autocomplete,c=e.upHandler,l=e.downHandler,h=e.class,p=o((V(t={},h,h),V(t,n,!0),V(t,"".concat(n,"-disabled"),i),V(t,"".concat(n,"-focused"),this.$data.focused),t)),f="",d="",v=this.$data.sValue;if(v||0===v)if(isNaN(v))f="".concat(n,"-handler-up-disabled"),d="".concat(n,"-handler-down-disabled");else{var m=Number(v);m>=this.max&&(f="".concat(n,"-handler-up-disabled")),m<=this.min&&(d="".concat(n,"-handler-down-disabled"))}var g={};for(var b in e)!e.hasOwnProperty(b)||"data-"!==b.substr(0,5)&&"aria-"!==b.substr(0,5)&&"role"!==b||(g[b]=e[b]);var y,O,w=!this.readonly&&!this.disabled,C=this.getInputDisplayValue();s?(y={onTouchstart:w&&!f&&this.up,onTouchend:this.stop},O={onTouchstart:w&&!d&&this.down,onTouchend:this.stop}):(y={onMousedown:w&&!f&&this.up,onMouseup:this.stop,onMouseleave:this.stop},O={onMousedown:w&&!d&&this.down,onMouseup:this.stop,onMouseleave:this.stop});var S=!!f||i||r,M=!!d||i||r,E=T(T({disabled:S,prefixCls:n,unselectable:"unselectable",role:"button","aria-label":"Increase Value","aria-disabled":!!S,class:"".concat(n,"-handler ").concat(n,"-handler-up ").concat(f)},y),{ref:this.saveUp}),j=T(T({disabled:M,prefixCls:n,unselectable:"unselectable",role:"button","aria-label":"Decrease Value","aria-disabled":!!M,class:"".concat(n,"-handler ").concat(n,"-handler-down ").concat(d)},O),{ref:this.saveDown});return u("div",{class:p,style:e.style,title:e.title,onMouseenter:e.onMouseenter,onMouseleave:e.onMouseleave,onMouseover:e.onMouseover,onMouseout:e.onMouseout},[u("div",{class:"".concat(n,"-handler-wrap")},[u("span",null,[u(x,P(P({},E),{},{key:"upHandler"}),{default:function(){return[c||u("span",{unselectable:"unselectable",class:"".concat(n,"-handler-up-inner"),onClick:N},null)]}})]),u(x,P(P({},j),{},{key:"downHandler"}),{default:function(){return[l||u("span",{unselectable:"unselectable",class:"".concat(n,"-handler-down-inner"),onClick:N},null)]}})]),u("div",{class:"".concat(n,"-input-wrap")},[u("input",P({role:"spinbutton","aria-valuemin":this.min,"aria-valuemax":this.max,"aria-valuenow":v,required:this.required,type:e.type,placeholder:this.placeholder,onClick:this.handleInputClick,class:"".concat(n,"-input"),tabindex:this.tabindex,autocomplete:a,onFocus:this.onFocus,onBlur:this.onBlur,onKeydown:w&&this.onKeyDown,onKeyup:w&&this.onKeyUp,autofocus:this.autofocus,maxlength:this.maxlength,readonly:this.readonly,disabled:this.disabled,max:this.max,min:this.min,step:this.step,name:this.name,title:this.title,id:this.id,onInput:this.onTrigger,onCompositionstart:this.onCompositionstart,onCompositionend:this.onCompositionend,ref:this.saveInput,value:C,pattern:this.pattern},g),null)])])}});function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(Object(n),!0).forEach((function(e){_(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function _(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F(){return(F=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}var R=p(e({name:"AInputNumber",inheritAttrs:!1,props:{prefixCls:t.string,min:t.number,max:t.number,value:t.oneOfType([t.number,t.string]),step:t.oneOfType([t.number,t.string]).def(1),defaultValue:t.oneOfType([t.number,t.string]),tabindex:t.number,disabled:t.looseBool,size:t.oneOf(f("large","small","default")),formatter:t.func,parser:t.func,decimalSeparator:t.string,placeholder:t.string,name:t.string,id:t.string,precision:t.number,autofocus:t.looseBool,onPressEnter:{type:Function},onChange:Function},setup:function(t){var e=d(null);return v((function(){m((function(){}))})),{configProvider:g("configProvider",b),inputNumberRef:e,focus:function(){e.value.focus()},blur:function(){e.value.blur()}}},render:function(){var t,e=F(F({},c(this)),this.$attrs),n=e.prefixCls,i=e.size,r=e.class,s=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(e,["prefixCls","size","class"]),a=(0,this.configProvider.getPrefixCls)("input-number",n),l=o((_(t={},"".concat(a,"-lg"),"large"===i),_(t,"".concat(a,"-sm"),"small"===i),t),r),h=F(F({prefixCls:a,upHandler:u(O,{class:"".concat(a,"-handler-up-inner")},null),downHandler:u(y,{class:"".concat(a,"-handler-down-inner")},null)},s),{class:l});return u(D,A(A({},h),{},{ref:"inputNumberRef"}),null)}}));export{R as I};

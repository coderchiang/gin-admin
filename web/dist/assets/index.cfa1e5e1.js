import{e as t,j as e,c as n,w as a}from"./index.36aa7878.js";import{z as u,A as o,a4 as r,i as s,b0 as l,a1 as i,r as c,u as d,Z as v,j as f,aK as p,K as m,o as C,m as y,P as S,X as b,q as g,N as x,ac as h,n as w}from"./vendor.0af35baf.js";function z(t,e="value",n="change"){const a=i(),c=null==a?void 0:a.emit,d=u({value:t[e]}),v=o(d);r((()=>{d.value=t[e]}));return[s({get:()=>d.value,set(t){l(t,v.value)||(d.value=t,null==c||c(n,t))}}),t=>{d.value=t},v]}var A=f({name:"CountButton",components:{Button:p},props:{value:{type:[Object,Number,String,Array]},count:{type:Number,default:60},beforeStartFunc:{type:Function,default:null}},setup(n){const a=c(!1),{currentCount:u,isStart:o,start:l,reset:i}=function(t){const e=c(t),n=c(!1);let a;function u(){a&&window.clearInterval(a)}function o(){n.value=!1,u(),a=null}function r(){d(n)||a||(n.value=!0,a=setInterval((()=>{1===d(e)?(o(),e.value=t):e.value-=1}),1e3))}function s(){e.value=t,o()}return v((()=>{s()})),{start:r,reset:s,restart:function(){s(),r()},clear:u,stop:o,currentCount:e,isStart:n}}(n.count),{t:f}=t(),p=s((()=>d(o)?f("component.countdown.sendText",[d(u)]):f("component.countdown.normalText")));return r((()=>{void 0===n.value&&i()})),{handleStart:function(){return t=this,u=null,o=function*(){const{beforeStartFunc:t}=n;if(t&&e(t)){a.value=!0;try{(yield t())&&l()}finally{a.value=!1}}else l()},new Promise(((e,n)=>{var a=t=>{try{s(o.next(t))}catch(e){n(e)}},r=t=>{try{s(o.throw(t))}catch(e){n(e)}},s=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,r);s((o=o.apply(t,u)).next())}));var t,u,o},currentCount:u,loading:a,getButtonText:p,isStart:o}}});A.render=function(t,e,n,a,u,o){const r=m("Button");return C(),y(r,x(t.$attrs,{disabled:t.isStart,onClick:t.handleStart,loading:t.loading}),{default:S((()=>[b(g(t.getButtonText),1)])),_:1},16,["disabled","onClick","loading"])};const B={value:{type:String},size:{type:String,validator:t=>["default","large","small"].includes(t)},count:{type:Number,default:60},sendCodeApi:{type:Function,default:null}};var F=f({name:"CountDownInput",components:{[h.name]:h,CountButton:A},inheritAttrs:!1,props:B,setup(t){const{prefixCls:e}=n("countdown-input"),[a]=z(t);return{prefixCls:e,state:a}}});F.render=function(t,e,n,a,u,o){const r=m("CountButton"),s=m("AInput");return C(),y(s,x(t.$attrs,{class:t.prefixCls,size:t.size,value:t.state}),{addonAfter:S((()=>[w(r,{size:t.size,count:t.count,value:t.state,beforeStartFunc:t.sendCodeApi},null,8,["size","count","value","beforeStartFunc"])])),_:1},16,["class","size","value"])};const j=a(F);a(A);export{j as C,z as u};

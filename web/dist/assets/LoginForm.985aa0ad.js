var e=(e,a,t)=>new Promise(((l,s)=>{var o=e=>{try{i(t.next(e))}catch(a){s(a)}},n=e=>{try{i(t.throw(e))}catch(a){s(a)}},i=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,n);i((t=t.apply(e,a)).next())}));import{j as a,aR as t,aS as l,aT as s,aK as o,aU as n,ac as i,aV as r,aW as c,aX as d,aY as u,aZ as m,a_ as p,r as g,I as f,z as h,i as y,t as C,u as S,K as x,o as _,m as v,w as F,v as b,n as w,P as L,X as I,q as k,a$ as T,S as D}from"./vendor.0af35baf.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{_ as E,u as R,a as j,L as P,b as z}from"./LoginFormTitle.d848bbd2.js";import{c as M,f as G,e as A,h as B}from"./index.3d8324dd.js";var U=a({name:"LoginForm",components:{[t.name]:t,[l.name]:l,Checkbox:s,Button:o,Form:n,FormItem:n.Item,Input:i,Divider:r,LoginFormTitle:E,InputPassword:i.Password,GithubFilled:c,WechatFilled:d,AlipayCircleFilled:u,GoogleCircleFilled:m,TwitterCircleFilled:p},setup(){const{t:a}=A(),{notification:t,createErrorModal:l}=B(),{prefixCls:s}=M("login"),o=G(),{setLoginState:n,getLoginState:i}=R(),{getFormRules:r}=j(),c=g(),d=g(!1),u=g(!1);f((()=>{x()}));const m=h({loading:!1,CaptchaSrc:"",CaptchaId:""}),p=h({account:"guest",password:"123456",captcha:"",captchaId:m.CaptchaId});function x(){return e(this,null,(function*(){const e=yield o.loadCaptcha();m.CaptchaSrc=e.CaptchaSrc,m.CaptchaId=e.CaptchaId}))}const{validForm:_}=z(c),v=y((()=>S(i)===P.LOGIN));return{t:a,prefixCls:s,formRef:c,formData:p,getFormRules:r,rememberMe:u,formState:m,loadCaptcha:x,handleLogin:function(){return e(this,null,(function*(){const e=yield _();if(e)try{d.value=!0;const l=yield o.login(C({password:e.password,username:e.account,captcha:e.captcha,captchaId:m.CaptchaId}));l&&t.success({message:a("sys.login.loginSuccessTitle"),description:`${a("sys.login.loginSuccessDesc")}: ${l.username}`,duration:3})}catch(n){l({title:a("sys.api.errorTip"),content:n.message||a("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${s}`)||document.body})}finally{d.value=!1}}))},loading:d,setLoginState:n,LoginStateEnum:P,getShow:v}}});U.render=function(e,a,t,l,s,o){const n=x("LoginFormTitle"),i=x("Input"),r=x("FormItem"),c=x("InputPassword"),d=x("ACol"),u=x("ARow"),m=x("Checkbox"),p=x("Button"),g=x("Divider"),f=x("GithubFilled"),h=x("WechatFilled"),y=x("AlipayCircleFilled"),C=x("GoogleCircleFilled"),S=x("TwitterCircleFilled"),E=x("Form");return _(),v(D,null,[F(w(n,{class:"enter-x"},null,512),[[b,e.getShow]]),F(w(E,{class:"p-4 enter-x",model:e.formData,rules:e.getFormRules,ref:"formRef",onKeypress:T(e.handleLogin,["enter"])},{default:L((()=>[w(r,{name:"account",class:"enter-x"},{default:L((()=>[w(i,{size:"large",value:e.formData.account,"onUpdate:value":a[1]||(a[1]=a=>e.formData.account=a),placeholder:e.t("sys.login.userName")},null,8,["value","placeholder"])])),_:1}),w(r,{name:"password",class:"enter-x"},{default:L((()=>[w(c,{size:"large",visibilityToggle:"",value:e.formData.password,"onUpdate:value":a[2]||(a[2]=a=>e.formData.password=a),placeholder:e.t("sys.login.password")},null,8,["value","placeholder"])])),_:1}),F(w(u,{class:"enter-x"},{default:L((()=>[w(d,null,{default:L((()=>[w(r,{class:"code-input",name:"captcha"},{default:L((()=>[w(i,{size:"large",visibilityToggle:"",value:e.formData.captcha,"onUpdate:value":a[3]||(a[3]=a=>e.formData.captcha=a),placeholder:e.t("sys.login.captcha")},null,8,["value","placeholder"])])),_:1}),F(w("img",{src:e.formState.CaptchaSrc,onClick:a[4]||(a[4]=(...a)=>e.loadCaptcha&&e.loadCaptcha(...a)),alt:"captcha",class:"code-image"},null,8,["src"]),[[b,!0]])])),_:1})])),_:1},512),[[b,!0]]),w(u,{class:"enter-x"},{default:L((()=>[w(d,{span:12},{default:L((()=>[w(r,null,{default:L((()=>[w(m,{checked:e.rememberMe,"onUpdate:checked":a[5]||(a[5]=a=>e.rememberMe=a),size:"small"},{default:L((()=>[I(k(e.t("sys.login.rememberMe")),1)])),_:1},8,["checked"])])),_:1})])),_:1}),w(d,{span:12},{default:L((()=>[w(r,{style:{"text-align":"right"}},{default:L((()=>[w(p,{type:"link",size:"small",onClick:a[6]||(a[6]=a=>e.setLoginState(e.LoginStateEnum.RESET_PASSWORD))},{default:L((()=>[I(k(e.t("sys.login.forgetPassword")),1)])),_:1})])),_:1})])),_:1})])),_:1}),w(r,{class:"enter-x"},{default:L((()=>[w(p,{type:"primary",size:"large",block:"",onClick:e.handleLogin,loading:e.loading},{default:L((()=>[I(k(e.t("sys.login.loginButton")),1)])),_:1},8,["onClick","loading"])])),_:1}),w(u,{class:"enter-x"},{default:L((()=>[w(d,{xs:24,md:8},{default:L((()=>[w(p,{block:"",onClick:a[7]||(a[7]=a=>e.setLoginState(e.LoginStateEnum.MOBILE))},{default:L((()=>[I(k(e.t("sys.login.mobileSignInFormTitle")),1)])),_:1})])),_:1}),w(d,{md:8,xs:24,class:"!my-2 !md:my-0 xs:mx-0 md:mx-2"},{default:L((()=>[w(p,{block:"",onClick:a[8]||(a[8]=a=>e.setLoginState(e.LoginStateEnum.QR_CODE))},{default:L((()=>[I(k(e.t("sys.login.qrSignInFormTitle")),1)])),_:1})])),_:1}),w(d,{md:7,xs:24},{default:L((()=>[w(p,{block:"",onClick:a[9]||(a[9]=a=>e.setLoginState(e.LoginStateEnum.REGISTER))},{default:L((()=>[I(k(e.t("sys.login.registerButton")),1)])),_:1})])),_:1})])),_:1}),w(g,{class:"enter-x"},{default:L((()=>[I(k(e.t("sys.login.otherSignIn")),1)])),_:1}),w("div",{class:["flex justify-evenly enter-x",`${e.prefixCls}-sign-in-way`]},[w(f),w(h),w(y),w(C),w(S)],2)])),_:1},8,["model","rules","onKeypress"]),[[b,e.getShow]])],64)};export default U;

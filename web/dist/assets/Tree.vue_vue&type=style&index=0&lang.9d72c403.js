var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,c=(t,l,n)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[l]=n,r=(e,t)=>{for(var l in t||(t={}))a.call(t,l)&&c(e,l,t[l]);if(n)for(var l of n(t))s.call(t,l)&&c(e,l,t[l]);return e},o=(e,n)=>t(e,l(n)),i=(e,t,l)=>new Promise(((n,a)=>{var s=e=>{try{r(l.next(e))}catch(t){a(t)}},c=e=>{try{r(l.throw(e))}catch(t){a(t)}},r=e=>e.done?n(e.value):Promise.resolve(e.value).then(s,c);r((l=l.apply(e,t)).next())}));import{a0 as d,j as u,av as y,aw as p,ac as h,i as f,D as v,k as b,l as k,K as m,o as K,m as L,Q as x,W as C,X as g,q as A,n as _,at as E,S,ag as N,x as T,u as I,al as w,r as j,I as D,J as M,$ as O,aV as B,bl as P,aJ as U,a1 as R,z as $,t as X,an as H,a4 as Y,C as F,w as z,v as J,bX as W,N as q,af as Q,bm as V}from"./vendor.0af35baf.js";import{i as G,_ as Z,ap as ee,p as te,e as le,aK as ne,aL as ae,c as se,j as ce,aC as re,S as oe,aM as ie,ac as de,C as ue}from"./index.b0556464.js";/* empty css              */import{u as ye}from"./useExpose.615d046e.js";const pe=({icon:e})=>e?G(e)?d(Z,{icon:e,class:"mr-1"}):Z:null;var he,fe;(fe=he||(he={}))[fe.SELECT_ALL=0]="SELECT_ALL",fe[fe.UN_SELECT_ALL=1]="UN_SELECT_ALL",fe[fe.EXPAND_ALL=2]="EXPAND_ALL",fe[fe.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",fe[fe.CHECK_STRICTLY=4]="CHECK_STRICTLY",fe[fe.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY";var ve=u({name:"BasicTreeHeader",components:{BasicTitle:ee,Icon:Z,Dropdown:y,Menu:p,MenuItem:p.Item,MenuDivider:p.Divider,InputSearch:h.Search},props:{helpMessage:{type:[String,Array],default:""},title:te.string,toolbar:te.bool,checkable:te.bool,search:te.bool,checkAll:te.func,expandAll:te.func},emits:["strictly-change","search"],setup(e,{emit:t}){const{t:l}=le(),n=f((()=>{const{checkable:t}=e,n=[{label:l("component.tree.expandAll"),value:he.EXPAND_ALL},{label:l("component.tree.unExpandAll"),value:he.UN_EXPAND_ALL,divider:t}];return t?[{label:l("component.tree.selectAll"),value:he.SELECT_ALL},{label:l("component.tree.unSelectAll"),value:he.UN_SELECT_ALL,divider:t},...n,{label:l("component.tree.checkStrictly"),value:he.CHECK_STRICTLY},{label:l("component.tree.checkUnStrictly"),value:he.CHECK_UN_STRICTLY}]:n}));const a=v((function(e){t("search",e)}),200);return{t:l,toolbarList:n,handleMenuClick:function(l){var n,a,s,c;const{key:r}=l;switch(r){case he.SELECT_ALL:null==(n=e.checkAll)||n.call(e,!0);break;case he.UN_SELECT_ALL:null==(a=e.checkAll)||a.call(e,!1);break;case he.EXPAND_ALL:null==(s=e.expandAll)||s.call(e,!0);break;case he.UN_EXPAND_ALL:null==(c=e.expandAll)||c.call(e,!1);break;case he.CHECK_STRICTLY:t("strictly-change",!1);break;case he.CHECK_UN_STRICTLY:t("strictly-change",!0)}},handleSearch:function(e){a(e.target.value)}}}});const be=T();b("data-v-c31eb57c");const ke={class:"flex px-2 py-1.5 items-center basic-tree-header"},me={key:2,class:"flex flex-1 justify-end items-center cursor-pointer"},Ke={key:0,class:"mr-1 w-2/3"};k();const Le=be(((e,t,l,n,a,s)=>{const c=m("BasicTitle"),r=m("InputSearch"),o=m("Icon"),i=m("MenuItem"),d=m("MenuDivider"),u=m("Menu"),y=m("Dropdown");return K(),L("div",ke,[e.$slots.headerTitle?x(e.$slots,"headerTitle",{key:0},void 0,!0):C("",!0),!e.$slots.headerTitle&&e.title?(K(),L(c,{key:1,helpMessage:e.helpMessage},{default:be((()=>[g(A(e.title),1)])),_:1},8,["helpMessage"])):C("",!0),e.search||e.toolbar?(K(),L("div",me,[e.search?(K(),L("div",Ke,[_(r,{placeholder:e.t("common.searchText"),size:"small",allowClear:"",onChange:e.handleSearch},null,8,["placeholder","onChange"])])):C("",!0),e.toolbar?(K(),L(y,{key:1,onClick:t[1]||(t[1]=E((()=>{}),["prevent"]))},{overlay:be((()=>[_(u,{onClick:e.handleMenuClick},{default:be((()=>[(K(!0),L(S,null,N(e.toolbarList,(e=>(K(),L(S,{key:e.value},[_(i,{key:e.value},{default:be((()=>[g(A(e.label),1)])),_:2},1040),e.divider?(K(),L(d,{key:0})):C("",!0)],64)))),128))])),_:1},8,["onClick"])])),default:be((()=>[_(o,{icon:"ion:ellipsis-vertical"})])),_:1})):C("",!0)])):C("",!0)])}));ve.render=Le,ve.__scopeId="data-v-c31eb57c";const xe={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default:()=>({x:0,y:0})},items:{type:Array,default:()=>[]}},Ce=e=>{const{item:t}=e;return _("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&_(Z,{class:"mr-2",icon:t.icon},null),_("span",null,[t.label])])};var ge=u({name:"ContextMenu",props:xe,setup(e){const t=j(null),l=j(!1),n=f((()=>{const{axis:t,items:l,styles:n,width:a}=e,{x:s,y:c}=t||{x:0,y:0},i=40*(l||[]).length,d=a,u=document.body,y=u.clientWidth<s+d?s-d:s,p=u.clientHeight<c+i?c-i:c;return o(r({},n),{width:`${a}px`,left:`${y+1}px`,top:`${p+1}px`})}));function a(e,t){const{handler:n,disabled:a}=e;a||(l.value=!1,null==t||t.stopPropagation(),null==t||t.preventDefault(),null==n||n())}function s(t){return t.map((t=>{const{disabled:n,label:c,children:r,divider:o=!1}=t,i={item:t,handler:a,showIcon:e.showIcon};return r&&0!==r.length?I(l)?_(p.SubMenu,{key:c,disabled:n,popupClassName:"context-menu__popup"},{title:()=>_(Ce,i,null),default:()=>s(r)}):null:_(S,null,[_(p.Item,{disabled:n,class:"context-menu__item",key:c},{default:()=>[_(Ce,i,null)]}),o?_(B,{key:`d-${c}`},null):null])}))}return D((()=>{M((()=>l.value=!0))})),O((()=>{const e=I(t);e&&document.body.removeChild(e)})),()=>{let a;if(!I(l))return null;const{items:c}=e;return _(p,{inlineIndent:12,mode:"vertical",class:"context-menu",ref:t,style:I(n)},"function"==typeof(r=a=s(c))||"[object Object]"===Object.prototype.toString.call(r)&&!P(r)?a:{default:()=>[a]});var r}}});const Ae={domList:[],resolve:()=>{}},_e=function(e){const{event:t}=e||{};if(t&&(null==t||t.preventDefault()),ae)return new Promise((l=>{const n=document.body,a=document.createElement("div"),s={};e.styles&&(s.styles=e.styles),e.items&&(s.items=e.items),e.event&&(s.customEvent=t,s.axis={x:t.clientX,y:t.clientY});const c=_(ge,s);U(c,a);const r=function(){Ae.resolve("")};Ae.domList.push(a);const o=function(){Ae.domList.forEach((e=>{try{e&&n.removeChild(e)}catch(t){}})),n.removeEventListener("click",r),n.removeEventListener("scroll",r)};Ae.resolve=function(e){o(),l(e)},o(),n.appendChild(a),n.addEventListener("click",r),n.addEventListener("scroll",r)}))},Ee=function(){Ae&&(Ae.resolve(""),Ae.domList=[])};var Se=u({name:"BasicTree",inheritAttrs:!1,props:{value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:te.string,toolbar:te.bool,search:te.bool,checkStrictly:te.bool,clickRowToExpand:te.bool.def(!0),checkable:te.bool.def(!1),defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:te.bool.def(!1),replaceFields:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:null},rightMenuList:{type:Array}},emits:["update:expandedKeys","update:selectedKeys","update:value","change","check"],setup(e,{attrs:t,slots:l,emit:n}){const a=$({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),s=$({startSearch:!1,searchData:[]}),c=j([]),[d]=function(e=!0){return R()&&e&&O((()=>{Ee()})),[_e,Ee]}(),{prefixCls:u}=se("basic-tree"),y=f((()=>{const{replaceFields:t}=e;return r({children:"children",title:"title",key:"key"},t)})),p=f((()=>{let l=o(r(r({blockNode:!0},t),e),{expandedKeys:a.expandedKeys,selectedKeys:a.selectedKeys,checkedKeys:a.checkedKeys,checkStrictly:a.checkStrictly,replaceFields:I(y),"onUpdate:expandedKeys":e=>{a.expandedKeys=e,n("update:expandedKeys",e)},"onUpdate:selectedKeys":e=>{a.selectedKeys=e,n("update:selectedKeys",e)},onCheck:(e,t)=>{a.checkedKeys=e;const l=X(e);n("update:value",l),n("check",l,t)},onRightClick:x});return l=H(l,"treeData","class"),l})),h=f((()=>s.startSearch?s.searchData:I(c))),v=f((()=>{var e;return s.startSearch&&0===(null==(e=s.searchData)?void 0:e.length)})),{deleteNodeByKey:b,insertNodeByKey:k,filterByLevel:m,updateNodeByKey:K,getAllKeys:L}=function(e,t){return{deleteNodeByKey:function l(n,a){if(!n)return;const s=a||I(e),{key:c,children:r}=I(t);if(r&&c)for(let e=0;e<s.length;e++){const t=s[e],a=t[r];if(t[c]===n){s.splice(e,1);break}a&&a.length&&l(n,t[r])}},insertNodeByKey:function({parentKey:l=null,node:n,push:a="push"}){const s=w(I(e));if(!l)return s[a](n),void(e.value=s);const{key:c,children:r}=I(t);r&&c&&(ne(s,(e=>{e[c]===l&&(e[r]=e[r]||[],e[r][a](n))})),e.value=s)},filterByLevel:function l(n=1,a,s=1){if(!n)return[];const c=[],r=a||I(e)||[];for(let e=0;e<r.length;e++){const a=r[e],{key:o,children:i}=I(t),d=o?a[o]:"",u=i?a[i]:[];c.push(d),u&&u.length&&s<n&&(s+=1,c.push(...l(n,u,s)))}return c},updateNodeByKey:function l(n,a,s){if(!n)return;const c=s||I(e),{key:o,children:i}=I(t);if(i&&o)for(let e=0;e<c.length;e++){const t=c[e],s=t[i];if(t[o]===n){c[e]=r(r({},c[e]),a);break}s&&s.length&&l(n,a,t[i])}},getAllKeys:function l(n){const a=[],s=n||I(e),{key:c,children:r}=I(t);if(!r||!c)return a;for(let e=0;e<s.length;e++){const t=s[e];a.push(t[c]);const n=t[r];n&&n.length&&a.push(...l(n))}return a}}}(c,y);function x(t){return i(this,arguments,(function*({event:t,node:l}){var n;const{rightMenuList:a=[],beforeRightClick:s}=e;let c={event:t,items:[]};if(s&&ce(s)){let e=yield s(l,t);Array.isArray(e)?c.items=e:Object.assign(c,e)}else c.items=a;(null==(n=c.items)?void 0:n.length)&&d(c)}))}function C(e){a.expandedKeys=e}function g(e){a.checkedKeys=e?L():[]}function A(e){a.expandedKeys=e?L():[]}function E(e){a.checkStrictly=e}function N(e){if(!e)return void(s.startSearch=!1);s.startSearch=!0;const{title:t}=I(y);s.searchData=ie(I(c),(l=>{var n,a;return null!=(a=null==(n=l[t])?void 0:n.includes(e))&&a}),I(y))}function T(t,l){if(e.clickRowToExpand&&l&&0!==l.length)if(a.expandedKeys.includes(t)){const e=[...a.expandedKeys],l=e.findIndex((e=>e===t));-1!==l&&e.splice(l,1),C(e)}else C([...a.expandedKeys,t])}Y((()=>{c.value=e.treeData})),D((()=>{const t=parseInt(e.defaultExpandLevel);t>0?a.expandedKeys=m(t):e.defaultExpandAll&&A(!0)})),Y((()=>{a.expandedKeys=e.expandedKeys})),Y((()=>{a.selectedKeys=e.selectedKeys})),Y((()=>{a.checkedKeys=e.checkedKeys})),F((()=>e.value),(()=>{a.checkedKeys=X(e.value||[])})),F((()=>a.checkedKeys),(()=>{const e=X(a.checkedKeys);n("update:value",e),n("change",e)})),Y((()=>{a.checkStrictly=e.checkStrictly}));function M(t){const{actionList:l}=e;if(l&&0!==l.length)return l.map(((e,l)=>{var n;let a=!0;return ce(e.show)?a=null==(n=e.show)?void 0:n.call(e,t):ue(e.show)&&(a=e.show),a?_("span",{key:l,class:`${u}__action`},[e.render(t)]):null}))}function B({data:t,level:n}){return t?t.map((t=>{const{title:a,key:s,children:c}=I(y),i=H(t,"title"),d=function(t,l){return!l&&e.renderIcon&&ce(e.renderIcon)?e.renderIcon(t):l}(o(r({},t),{level:n}),t.icon),h=V(t,c)||[];return _(W.TreeNode,q(i,{node:X(t),key:V(t,s)}),{title:()=>{var e;return _("span",{class:`${u}-title pl-2`,onClick:T.bind(null,t[s],t[c])},[(null==l?void 0:l.title)?de(l,"title",t):_(S,null,[d&&_(pe,{icon:d},null),_("span",{class:(null==(e=I(p))?void 0:e.blockNode)?`${u}__content`:""},[V(t,a)]),_("span",{class:`${u}__actions`},[M(o(r({},t),{level:n}))])])])},default:()=>B({data:h,level:n+1})})})):null}return ye({setExpandedKeys:C,getExpandedKeys:function(){return a.expandedKeys},setSelectedKeys:function(e){a.selectedKeys=e},getSelectedKeys:function(){return a.selectedKeys},setCheckedKeys:function(e){a.checkedKeys=e},getCheckedKeys:function(){return a.checkedKeys},insertNodeByKey:k,deleteNodeByKey:b,updateNodeByKey:K,checkAll:g,expandAll:A,filterByLevel:e=>{a.expandedKeys=m(e)}}),()=>{let n;const{title:a,helpMessage:s,toolbar:c,search:o,checkable:i}=e,d=a||c||o||l.headerTitle;return _("div",{class:[u,"h-full",t.class]},[d&&_(ve,{checkable:i,checkAll:g,expandAll:A,title:a,search:o,toolbar:c,helpMessage:s,onStrictlyChange:E,onSearch:N},(y=n=re(l),"function"==typeof y||"[object Object]"===Object.prototype.toString.call(y)&&!P(y)?n:{default:()=>[n]})),z(_(oe,{style:{height:"calc(100% - 38px)"}},{default:()=>[_(W,q(I(p),{showIcon:!1}),r({default:()=>B({data:I(h),level:1})},re(l)))]}),[[J,!I(v)]]),z(_(Q,{class:"!mt-4"},null),[[J,I(v)]])]);var y}}});export{Se as _};
